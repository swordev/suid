var Z=Object.defineProperty;var f=(d,e)=>Z(d,"name",{value:e,configurable:!0});import{t as ee,m as te}from"./CodeEditor-85f0359e.js";import"./index-dcf73f67.js";import"./useControlled-3adf31ee.js";/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.43.0(94c055bcbdd49f04a0fa15515e848542a79fb948)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var Q=Object.defineProperty,re=Object.getOwnPropertyDescriptor,se=Object.getOwnPropertyNames,ie=Object.prototype.hasOwnProperty,ne=f((d,e,t)=>e in d?Q(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t,"__defNormalProp"),J=f((d,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of se(e))!ie.call(d,i)&&i!==t&&Q(d,i,{get:()=>e[i],enumerable:!(o=re(e,i))||o.enumerable});return d},"__copyProps"),ae=f((d,e,t)=>(J(d,e,"default"),t&&J(t,e,"default")),"__reExport"),h=f((d,e,t)=>(ne(d,typeof e!="symbol"?e+"":e,t),t),"__publicField"),n={};ae(n,te);var C,oe=(C=class{constructor(e,t){this._modeId=e,this._defaults=t,this._worker=null,this._client=null,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker()),this._updateExtraLibsToken=0,this._extraLibsChangeListener=this._defaults.onDidExtraLibsChange(()=>this._updateExtraLibs())}_configChangeListener;_updateExtraLibsToken;_extraLibsChangeListener;_worker;_client;dispose(){this._configChangeListener.dispose(),this._extraLibsChangeListener.dispose(),this._stopWorker()}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}async _updateExtraLibs(){if(!this._worker)return;const e=++this._updateExtraLibsToken,t=await this._worker.getProxy();this._updateExtraLibsToken===e&&t.updateExtraLibs(this._defaults.getExtraLibs())}_getClient(){return this._client||(this._client=(async()=>(this._worker=n.editor.createWebWorker({moduleId:"vs/language/typescript/tsWorker",label:this._modeId,keepIdleModels:!0,createData:{compilerOptions:this._defaults.getCompilerOptions(),extraLibs:this._defaults.getExtraLibs(),customWorkerPath:this._defaults.workerOptions.customWorkerPath,inlayHintsOptions:this._defaults.inlayHintsOptions}}),this._defaults.getEagerModelSync()?await this._worker.withSyncedResources(n.editor.getModels().filter(e=>e.getLanguageId()===this._modeId).map(e=>e.uri)):await this._worker.getProxy()))()),this._client}async getLanguageServiceWorker(...e){const t=await this._getClient();return this._worker&&await this._worker.withSyncedResources(e),t}},f(C,"WorkerManager"),C),s={};s["lib.d.ts"]=!0;s["lib.decorators.d.ts"]=!0;s["lib.decorators.legacy.d.ts"]=!0;s["lib.dom.d.ts"]=!0;s["lib.dom.iterable.d.ts"]=!0;s["lib.es2015.collection.d.ts"]=!0;s["lib.es2015.core.d.ts"]=!0;s["lib.es2015.d.ts"]=!0;s["lib.es2015.generator.d.ts"]=!0;s["lib.es2015.iterable.d.ts"]=!0;s["lib.es2015.promise.d.ts"]=!0;s["lib.es2015.proxy.d.ts"]=!0;s["lib.es2015.reflect.d.ts"]=!0;s["lib.es2015.symbol.d.ts"]=!0;s["lib.es2015.symbol.wellknown.d.ts"]=!0;s["lib.es2016.array.include.d.ts"]=!0;s["lib.es2016.d.ts"]=!0;s["lib.es2016.full.d.ts"]=!0;s["lib.es2017.d.ts"]=!0;s["lib.es2017.full.d.ts"]=!0;s["lib.es2017.intl.d.ts"]=!0;s["lib.es2017.object.d.ts"]=!0;s["lib.es2017.sharedmemory.d.ts"]=!0;s["lib.es2017.string.d.ts"]=!0;s["lib.es2017.typedarrays.d.ts"]=!0;s["lib.es2018.asyncgenerator.d.ts"]=!0;s["lib.es2018.asynciterable.d.ts"]=!0;s["lib.es2018.d.ts"]=!0;s["lib.es2018.full.d.ts"]=!0;s["lib.es2018.intl.d.ts"]=!0;s["lib.es2018.promise.d.ts"]=!0;s["lib.es2018.regexp.d.ts"]=!0;s["lib.es2019.array.d.ts"]=!0;s["lib.es2019.d.ts"]=!0;s["lib.es2019.full.d.ts"]=!0;s["lib.es2019.intl.d.ts"]=!0;s["lib.es2019.object.d.ts"]=!0;s["lib.es2019.string.d.ts"]=!0;s["lib.es2019.symbol.d.ts"]=!0;s["lib.es2020.bigint.d.ts"]=!0;s["lib.es2020.d.ts"]=!0;s["lib.es2020.date.d.ts"]=!0;s["lib.es2020.full.d.ts"]=!0;s["lib.es2020.intl.d.ts"]=!0;s["lib.es2020.number.d.ts"]=!0;s["lib.es2020.promise.d.ts"]=!0;s["lib.es2020.sharedmemory.d.ts"]=!0;s["lib.es2020.string.d.ts"]=!0;s["lib.es2020.symbol.wellknown.d.ts"]=!0;s["lib.es2021.d.ts"]=!0;s["lib.es2021.full.d.ts"]=!0;s["lib.es2021.intl.d.ts"]=!0;s["lib.es2021.promise.d.ts"]=!0;s["lib.es2021.string.d.ts"]=!0;s["lib.es2021.weakref.d.ts"]=!0;s["lib.es2022.array.d.ts"]=!0;s["lib.es2022.d.ts"]=!0;s["lib.es2022.error.d.ts"]=!0;s["lib.es2022.full.d.ts"]=!0;s["lib.es2022.intl.d.ts"]=!0;s["lib.es2022.object.d.ts"]=!0;s["lib.es2022.regexp.d.ts"]=!0;s["lib.es2022.sharedmemory.d.ts"]=!0;s["lib.es2022.string.d.ts"]=!0;s["lib.es2023.array.d.ts"]=!0;s["lib.es2023.d.ts"]=!0;s["lib.es2023.full.d.ts"]=!0;s["lib.es5.d.ts"]=!0;s["lib.es6.d.ts"]=!0;s["lib.esnext.d.ts"]=!0;s["lib.esnext.full.d.ts"]=!0;s["lib.esnext.intl.d.ts"]=!0;s["lib.scripthost.d.ts"]=!0;s["lib.webworker.d.ts"]=!0;s["lib.webworker.importscripts.d.ts"]=!0;s["lib.webworker.iterable.d.ts"]=!0;function $(d,e,t=0){if(typeof d=="string")return d;if(d===void 0)return"";let o="";if(t){o+=e;for(let i=0;i<t;i++)o+="  "}if(o+=d.messageText,t++,d.next)for(const i of d.next)o+=$(i,e,t);return o}f($,"flattenDiagnosticMessageText");function k(d){return d?d.map(e=>e.text).join(""):""}f(k,"displayPartsToString");var D,y=(D=class{constructor(e){this._worker=e}_textSpanToRange(e,t){let o=e.getPositionAt(t.start),i=e.getPositionAt(t.start+t.length),{lineNumber:c,column:p}=o,{lineNumber:a,column:r}=i;return{startLineNumber:c,startColumn:p,endLineNumber:a,endColumn:r}}},f(D,"Adapter"),D),F,le=(F=class{constructor(e){this._worker=e,this._libFiles={},this._hasFetchedLibFiles=!1,this._fetchLibFilesPromise=null}_libFiles;_hasFetchedLibFiles;_fetchLibFilesPromise;isLibFile(e){return e&&e.path.indexOf("/lib.")===0?!!s[e.path.slice(1)]:!1}getOrCreateModel(e){const t=n.Uri.parse(e),o=n.editor.getModel(t);if(o)return o;if(this.isLibFile(t)&&this._hasFetchedLibFiles)return n.editor.createModel(this._libFiles[t.path.slice(1)],"typescript",t);const i=ee.getExtraLibs()[e];return i?n.editor.createModel(i.content,"typescript",t):null}_containsLibFile(e){for(let t of e)if(this.isLibFile(t))return!0;return!1}async fetchLibFilesIfNecessary(e){this._containsLibFile(e)&&await this._fetchLibFiles()}_fetchLibFiles(){return this._fetchLibFilesPromise||(this._fetchLibFilesPromise=this._worker().then(e=>e.getLibFiles()).then(e=>{this._hasFetchedLibFiles=!0,this._libFiles=e})),this._fetchLibFilesPromise}},f(F,"LibFiles"),F),A,ce=(A=class extends y{constructor(e,t,o,i){super(i),this._libFiles=e,this._defaults=t,this._selector=o;const c=f(r=>{if(r.getLanguageId()!==o)return;const u=f(()=>{const{onlyVisible:_}=this._defaults.getDiagnosticsOptions();_?r.isAttachedToEditor()&&this._doValidate(r):this._doValidate(r)},"maybeValidate");let g;const b=r.onDidChangeContent(()=>{clearTimeout(g),g=window.setTimeout(u,500)}),m=r.onDidChangeAttached(()=>{const{onlyVisible:_}=this._defaults.getDiagnosticsOptions();_&&(r.isAttachedToEditor()?u():n.editor.setModelMarkers(r,this._selector,[]))});this._listener[r.uri.toString()]={dispose(){b.dispose(),m.dispose(),clearTimeout(g)}},u()},"onModelAdd"),p=f(r=>{n.editor.setModelMarkers(r,this._selector,[]);const u=r.uri.toString();this._listener[u]&&(this._listener[u].dispose(),delete this._listener[u])},"onModelRemoved");this._disposables.push(n.editor.onDidCreateModel(r=>c(r))),this._disposables.push(n.editor.onWillDisposeModel(p)),this._disposables.push(n.editor.onDidChangeModelLanguage(r=>{p(r.model),c(r.model)})),this._disposables.push({dispose(){for(const r of n.editor.getModels())p(r)}});const a=f(()=>{for(const r of n.editor.getModels())p(r),c(r)},"recomputeDiagostics");this._disposables.push(this._defaults.onDidChange(a)),this._disposables.push(this._defaults.onDidExtraLibsChange(a)),n.editor.getModels().forEach(r=>c(r))}_disposables=[];_listener=Object.create(null);dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}async _doValidate(e){const t=await this._worker(e.uri);if(e.isDisposed())return;const o=[],{noSyntaxValidation:i,noSemanticValidation:c,noSuggestionDiagnostics:p}=this._defaults.getDiagnosticsOptions();i||o.push(t.getSyntacticDiagnostics(e.uri.toString())),c||o.push(t.getSemanticDiagnostics(e.uri.toString())),p||o.push(t.getSuggestionDiagnostics(e.uri.toString()));const a=await Promise.all(o);if(!a||e.isDisposed())return;const r=a.reduce((g,b)=>b.concat(g),[]).filter(g=>(this._defaults.getDiagnosticsOptions().diagnosticCodesToIgnore||[]).indexOf(g.code)===-1),u=r.map(g=>g.relatedInformation||[]).reduce((g,b)=>b.concat(g),[]).map(g=>g.file?n.Uri.parse(g.file.fileName):null);await this._libFiles.fetchLibFilesIfNecessary(u),!e.isDisposed()&&n.editor.setModelMarkers(e,this._selector,r.map(g=>this._convertDiagnostics(e,g)))}_convertDiagnostics(e,t){const o=t.start||0,i=t.length||1,{lineNumber:c,column:p}=e.getPositionAt(o),{lineNumber:a,column:r}=e.getPositionAt(o+i),u=[];return t.reportsUnnecessary&&u.push(n.MarkerTag.Unnecessary),t.reportsDeprecated&&u.push(n.MarkerTag.Deprecated),{severity:this._tsDiagnosticCategoryToMarkerSeverity(t.category),startLineNumber:c,startColumn:p,endLineNumber:a,endColumn:r,message:$(t.messageText,`
`),code:t.code.toString(),tags:u,relatedInformation:this._convertRelatedInformation(e,t.relatedInformation)}}_convertRelatedInformation(e,t){if(!t)return[];const o=[];return t.forEach(i=>{let c=e;if(i.file&&(c=this._libFiles.getOrCreateModel(i.file.fileName)),!c)return;const p=i.start||0,a=i.length||1,{lineNumber:r,column:u}=c.getPositionAt(p),{lineNumber:g,column:b}=c.getPositionAt(p+a);o.push({resource:c.uri,startLineNumber:r,startColumn:u,endLineNumber:g,endColumn:b,message:$(i.messageText,`
`)})}),o}_tsDiagnosticCategoryToMarkerSeverity(e){switch(e){case 1:return n.MarkerSeverity.Error;case 3:return n.MarkerSeverity.Info;case 0:return n.MarkerSeverity.Warning;case 2:return n.MarkerSeverity.Hint}return n.MarkerSeverity.Info}},f(A,"DiagnosticsAdapter"),A),T,U=(T=class extends y{get triggerCharacters(){return["."]}async provideCompletionItems(e,t,o,i){const c=e.getWordUntilPosition(t),p=new n.Range(t.lineNumber,c.startColumn,t.lineNumber,c.endColumn),a=e.uri,r=e.getOffsetAt(t),u=await this._worker(a);if(e.isDisposed())return;const g=await u.getCompletionsAtPosition(a.toString(),r);return!g||e.isDisposed()?void 0:{suggestions:g.entries.map(m=>{let _=p;if(m.replacementSpan){const x=e.getPositionAt(m.replacementSpan.start),B=e.getPositionAt(m.replacementSpan.start+m.replacementSpan.length);_=new n.Range(x.lineNumber,x.column,B.lineNumber,B.column)}const S=[];return m.kindModifiers!==void 0&&m.kindModifiers.indexOf("deprecated")!==-1&&S.push(n.languages.CompletionItemTag.Deprecated),{uri:a,position:t,offset:r,range:_,label:m.name,insertText:m.name,sortText:m.sortText,kind:U.convertKind(m.kind),tags:S}})}}async resolveCompletionItem(e,t){const o=e,i=o.uri,c=o.position,p=o.offset,r=await(await this._worker(i)).getCompletionEntryDetails(i.toString(),p,o.label);return r?{uri:i,position:c,label:r.name,kind:U.convertKind(r.kind),detail:k(r.displayParts),documentation:{value:U.createDocumentationString(r)}}:o}static convertKind(e){switch(e){case l.primitiveType:case l.keyword:return n.languages.CompletionItemKind.Keyword;case l.variable:case l.localVariable:return n.languages.CompletionItemKind.Variable;case l.memberVariable:case l.memberGetAccessor:case l.memberSetAccessor:return n.languages.CompletionItemKind.Field;case l.function:case l.memberFunction:case l.constructSignature:case l.callSignature:case l.indexSignature:return n.languages.CompletionItemKind.Function;case l.enum:return n.languages.CompletionItemKind.Enum;case l.module:return n.languages.CompletionItemKind.Module;case l.class:return n.languages.CompletionItemKind.Class;case l.interface:return n.languages.CompletionItemKind.Interface;case l.warning:return n.languages.CompletionItemKind.File}return n.languages.CompletionItemKind.Property}static createDocumentationString(e){let t=k(e.documentation);if(e.tags)for(const o of e.tags)t+=`

${q(o)}`;return t}},f(T,"SuggestAdapter"),T);function q(d){let e=`*@${d.name}*`;if(d.name==="param"&&d.text){const[t,...o]=d.text;e+=`\`${t.text}\``,o.length>0&&(e+=` — ${o.map(i=>i.text).join(" ")}`)}else Array.isArray(d.text)?e+=` — ${d.text.map(t=>t.text).join(" ")}`:d.text&&(e+=` — ${d.text}`);return e}f(q,"tagToString");var L,X=(L=class extends y{signatureHelpTriggerCharacters=["(",","];static _toSignatureHelpTriggerReason(e){switch(e.triggerKind){case n.languages.SignatureHelpTriggerKind.TriggerCharacter:return e.triggerCharacter?e.isRetrigger?{kind:"retrigger",triggerCharacter:e.triggerCharacter}:{kind:"characterTyped",triggerCharacter:e.triggerCharacter}:{kind:"invoked"};case n.languages.SignatureHelpTriggerKind.ContentChange:return e.isRetrigger?{kind:"retrigger"}:{kind:"invoked"};case n.languages.SignatureHelpTriggerKind.Invoke:default:return{kind:"invoked"}}}async provideSignatureHelp(e,t,o,i){const c=e.uri,p=e.getOffsetAt(t),a=await this._worker(c);if(e.isDisposed())return;const r=await a.getSignatureHelpItems(c.toString(),p,{triggerReason:X._toSignatureHelpTriggerReason(i)});if(!r||e.isDisposed())return;const u={activeSignature:r.selectedItemIndex,activeParameter:r.argumentIndex,signatures:[]};return r.items.forEach(g=>{const b={label:"",parameters:[]};b.documentation={value:k(g.documentation)},b.label+=k(g.prefixDisplayParts),g.parameters.forEach((m,_,S)=>{const x=k(m.displayParts),B={label:x,documentation:{value:k(m.documentation)}};b.label+=x,b.parameters.push(B),_<S.length-1&&(b.label+=k(g.separatorDisplayParts))}),b.label+=k(g.suffixDisplayParts),u.signatures.push(b)}),{value:u,dispose(){}}}},f(L,"SignatureHelpAdapter"),L),P,ue=(P=class extends y{async provideHover(e,t,o){const i=e.uri,c=e.getOffsetAt(t),p=await this._worker(i);if(e.isDisposed())return;const a=await p.getQuickInfoAtPosition(i.toString(),c);if(!a||e.isDisposed())return;const r=k(a.documentation),u=a.tags?a.tags.map(b=>q(b)).join(`  

`):"",g=k(a.displayParts);return{range:this._textSpanToRange(e,a.textSpan),contents:[{value:"```typescript\n"+g+"\n```\n"},{value:r+(u?`

`+u:"")}]}}},f(P,"QuickInfoAdapter"),P),O,ge=(O=class extends y{async provideDocumentHighlights(e,t,o){const i=e.uri,c=e.getOffsetAt(t),p=await this._worker(i);if(e.isDisposed())return;const a=await p.getDocumentHighlights(i.toString(),c,[i.toString()]);if(!(!a||e.isDisposed()))return a.flatMap(r=>r.highlightSpans.map(u=>({range:this._textSpanToRange(e,u.textSpan),kind:u.kind==="writtenReference"?n.languages.DocumentHighlightKind.Write:n.languages.DocumentHighlightKind.Text})))}},f(O,"DocumentHighlightAdapter"),O),I,de=(I=class extends y{constructor(e,t){super(t),this._libFiles=e}async provideDefinition(e,t,o){const i=e.uri,c=e.getOffsetAt(t),p=await this._worker(i);if(e.isDisposed())return;const a=await p.getDefinitionAtPosition(i.toString(),c);if(!a||e.isDisposed()||(await this._libFiles.fetchLibFilesIfNecessary(a.map(u=>n.Uri.parse(u.fileName))),e.isDisposed()))return;const r=[];for(let u of a){const g=this._libFiles.getOrCreateModel(u.fileName);g&&r.push({uri:g.uri,range:this._textSpanToRange(g,u.textSpan)})}return r}},f(I,"DefinitionAdapter"),I),N,pe=(N=class extends y{constructor(e,t){super(t),this._libFiles=e}async provideReferences(e,t,o,i){const c=e.uri,p=e.getOffsetAt(t),a=await this._worker(c);if(e.isDisposed())return;const r=await a.getReferencesAtPosition(c.toString(),p);if(!r||e.isDisposed()||(await this._libFiles.fetchLibFilesIfNecessary(r.map(g=>n.Uri.parse(g.fileName))),e.isDisposed()))return;const u=[];for(let g of r){const b=this._libFiles.getOrCreateModel(g.fileName);b&&u.push({uri:b.uri,range:this._textSpanToRange(b,g.textSpan)})}return u}},f(N,"ReferenceAdapter"),N),M,fe=(M=class extends y{async provideDocumentSymbols(e,t){const o=e.uri,i=await this._worker(o);if(e.isDisposed())return;const c=await i.getNavigationTree(o.toString());if(!c||e.isDisposed())return;const p=f((r,u)=>({name:r.text,detail:"",kind:w[r.kind]||n.languages.SymbolKind.Variable,range:this._textSpanToRange(e,r.spans[0]),selectionRange:this._textSpanToRange(e,r.spans[0]),tags:[],children:r.childItems?.map(b=>p(b,r.text)),containerName:u}),"convert");return c.childItems?c.childItems.map(r=>p(r)):[]}},f(M,"OutlineAdapter"),M),R,l=(R=class{},f(R,"Kind"),R);h(l,"unknown","");h(l,"keyword","keyword");h(l,"script","script");h(l,"module","module");h(l,"class","class");h(l,"interface","interface");h(l,"type","type");h(l,"enum","enum");h(l,"variable","var");h(l,"localVariable","local var");h(l,"function","function");h(l,"localFunction","local function");h(l,"memberFunction","method");h(l,"memberGetAccessor","getter");h(l,"memberSetAccessor","setter");h(l,"memberVariable","property");h(l,"constructorImplementation","constructor");h(l,"callSignature","call");h(l,"indexSignature","index");h(l,"constructSignature","construct");h(l,"parameter","parameter");h(l,"typeParameter","type parameter");h(l,"primitiveType","primitive type");h(l,"label","label");h(l,"alias","alias");h(l,"const","const");h(l,"let","let");h(l,"warning","warning");var w=Object.create(null);w[l.module]=n.languages.SymbolKind.Module;w[l.class]=n.languages.SymbolKind.Class;w[l.enum]=n.languages.SymbolKind.Enum;w[l.interface]=n.languages.SymbolKind.Interface;w[l.memberFunction]=n.languages.SymbolKind.Method;w[l.memberVariable]=n.languages.SymbolKind.Property;w[l.memberGetAccessor]=n.languages.SymbolKind.Property;w[l.memberSetAccessor]=n.languages.SymbolKind.Property;w[l.variable]=n.languages.SymbolKind.Variable;w[l.const]=n.languages.SymbolKind.Variable;w[l.localVariable]=n.languages.SymbolKind.Variable;w[l.variable]=n.languages.SymbolKind.Variable;w[l.function]=n.languages.SymbolKind.Function;w[l.localFunction]=n.languages.SymbolKind.Function;var K,v=(K=class extends y{static _convertOptions(e){return{ConvertTabsToSpaces:e.insertSpaces,TabSize:e.tabSize,IndentSize:e.tabSize,IndentStyle:2,NewLineCharacter:`
`,InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,PlaceOpenBraceOnNewLineForFunctions:!1}}_convertTextChanges(e,t){return{text:t.newText,range:this._textSpanToRange(e,t.span)}}},f(K,"FormatHelper"),K),E,be=(E=class extends v{canFormatMultipleRanges=!1;async provideDocumentRangeFormattingEdits(e,t,o,i){const c=e.uri,p=e.getOffsetAt({lineNumber:t.startLineNumber,column:t.startColumn}),a=e.getOffsetAt({lineNumber:t.endLineNumber,column:t.endColumn}),r=await this._worker(c);if(e.isDisposed())return;const u=await r.getFormattingEditsForRange(c.toString(),p,a,v._convertOptions(o));if(!(!u||e.isDisposed()))return u.map(g=>this._convertTextChanges(e,g))}},f(E,"FormatAdapter"),E),H,he=(H=class extends v{get autoFormatTriggerCharacters(){return[";","}",`
`]}async provideOnTypeFormattingEdits(e,t,o,i,c){const p=e.uri,a=e.getOffsetAt(t),r=await this._worker(p);if(e.isDisposed())return;const u=await r.getFormattingEditsAfterKeystroke(p.toString(),a,o,v._convertOptions(i));if(!(!u||e.isDisposed()))return u.map(g=>this._convertTextChanges(e,g))}},f(H,"FormatOnTypeAdapter"),H),V,me=(V=class extends v{async provideCodeActions(e,t,o,i){const c=e.uri,p=e.getOffsetAt({lineNumber:t.startLineNumber,column:t.startColumn}),a=e.getOffsetAt({lineNumber:t.endLineNumber,column:t.endColumn}),r=v._convertOptions(e.getOptions()),u=o.markers.filter(_=>_.code).map(_=>_.code).map(Number),g=await this._worker(c);if(e.isDisposed())return;const b=await g.getCodeFixesAtPosition(c.toString(),p,a,u,r);return!b||e.isDisposed()?{actions:[],dispose:()=>{}}:{actions:b.filter(_=>_.changes.filter(S=>S.isNewFile).length===0).map(_=>this._tsCodeFixActionToMonacoCodeAction(e,o,_)),dispose:()=>{}}}_tsCodeFixActionToMonacoCodeAction(e,t,o){const i=[];for(const p of o.changes)for(const a of p.textChanges)i.push({resource:e.uri,versionId:void 0,textEdit:{range:this._textSpanToRange(e,a.span),text:a.newText}});return{title:o.description,edit:{edits:i},diagnostics:t.markers,kind:"quickfix"}}},f(V,"CodeActionAdaptor"),V),W,_e=(W=class extends y{constructor(e,t){super(t),this._libFiles=e}async provideRenameEdits(e,t,o,i){const c=e.uri,p=c.toString(),a=e.getOffsetAt(t),r=await this._worker(c);if(e.isDisposed())return;const u=await r.getRenameInfo(p,a,{allowRenameOfImportPath:!1});if(u.canRename===!1)return{edits:[],rejectReason:u.localizedErrorMessage};if(u.fileToRename!==void 0)throw new Error("Renaming files is not supported.");const g=await r.findRenameLocations(p,a,!1,!1,!1);if(!g||e.isDisposed())return;const b=[];for(const m of g){const _=this._libFiles.getOrCreateModel(m.fileName);if(_)b.push({resource:_.uri,versionId:void 0,textEdit:{range:this._textSpanToRange(_,m.textSpan),text:o}});else throw new Error(`Unknown file ${m.fileName}.`)}return{edits:b}}},f(W,"RenameAdapter"),W),j,we=(j=class extends y{async provideInlayHints(e,t,o){const i=e.uri,c=i.toString(),p=e.getOffsetAt({lineNumber:t.startLineNumber,column:t.startColumn}),a=e.getOffsetAt({lineNumber:t.endLineNumber,column:t.endColumn}),r=await this._worker(i);return e.isDisposed()?null:{hints:(await r.provideInlayHints(c,p,a)).map(b=>({...b,label:b.text,position:e.getPositionAt(b.position),kind:this._convertHintKind(b.kind)})),dispose:()=>{}}}_convertHintKind(e){switch(e){case"Parameter":return n.languages.InlayHintKind.Parameter;case"Type":return n.languages.InlayHintKind.Type;default:return n.languages.InlayHintKind.Type}}},f(j,"InlayHintsAdapter"),j),z,G;function Ce(d){G=Y(d,"typescript")}f(Ce,"setupTypeScript");function De(d){z=Y(d,"javascript")}f(De,"setupJavaScript");function Fe(){return new Promise((d,e)=>{if(!z)return e("JavaScript not registered!");d(z)})}f(Fe,"getJavaScriptWorker");function Ae(){return new Promise((d,e)=>{if(!G)return e("TypeScript not registered!");d(G)})}f(Ae,"getTypeScriptWorker");function Y(d,e){const t=[],o=new oe(e,d),i=f((...a)=>o.getLanguageServiceWorker(...a),"worker"),c=new le(i);function p(){const{modeConfiguration:a}=d;ye(t),a.completionItems&&t.push(n.languages.registerCompletionItemProvider(e,new U(i))),a.signatureHelp&&t.push(n.languages.registerSignatureHelpProvider(e,new X(i))),a.hovers&&t.push(n.languages.registerHoverProvider(e,new ue(i))),a.documentHighlights&&t.push(n.languages.registerDocumentHighlightProvider(e,new ge(i))),a.definitions&&t.push(n.languages.registerDefinitionProvider(e,new de(c,i))),a.references&&t.push(n.languages.registerReferenceProvider(e,new pe(c,i))),a.documentSymbols&&t.push(n.languages.registerDocumentSymbolProvider(e,new fe(i))),a.rename&&t.push(n.languages.registerRenameProvider(e,new _e(c,i))),a.documentRangeFormattingEdits&&t.push(n.languages.registerDocumentRangeFormattingEditProvider(e,new be(i))),a.onTypeFormattingEdits&&t.push(n.languages.registerOnTypeFormattingEditProvider(e,new he(i))),a.codeActions&&t.push(n.languages.registerCodeActionProvider(e,new me(i))),a.inlayHints&&t.push(n.languages.registerInlayHintsProvider(e,new we(i))),a.diagnostics&&t.push(new ce(c,d,e,i))}return f(p,"registerProviders"),p(),i}f(Y,"setupMode");function ye(d){for(;d.length;)d.pop().dispose()}f(ye,"disposeAll");export{y as Adapter,me as CodeActionAdaptor,de as DefinitionAdapter,ce as DiagnosticsAdapter,ge as DocumentHighlightAdapter,be as FormatAdapter,v as FormatHelper,he as FormatOnTypeAdapter,we as InlayHintsAdapter,l as Kind,le as LibFiles,fe as OutlineAdapter,ue as QuickInfoAdapter,pe as ReferenceAdapter,_e as RenameAdapter,X as SignatureHelpAdapter,U as SuggestAdapter,oe as WorkerManager,$ as flattenDiagnosticMessageText,Fe as getJavaScriptWorker,Ae as getTypeScriptWorker,De as setupJavaScript,Ce as setupTypeScript};

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.StackBlitzSDK=t()}(this,function(){function e(e){return e&&e.origin?e.origin:"https://stackblitz.com"}var t="300";function n(){return Math.random().toString(36).substring(7)}function i(e){var t=[];return e&&(e.forceEmbedLayout&&t.push("embed=1"),e.clickToLoad&&t.push("ctl=1"),"string"==typeof e.openFile&&t.push("file="+e.openFile),Array.isArray(e.openFile)&&e.openFile.forEach(function(e){"string"==typeof e&&t.push("file="+e)}),"preview"!==e.view&&"editor"!==e.view||t.push("view="+e.view),"light"!==e.theme&&"dark"!==e.theme||t.push("theme="+e.theme),e.hideExplorer&&t.push("hideExplorer=1"),e.hideNavigation&&t.push("hideNavigation=1"),e.hideDevTools&&t.push("hidedevtools=1"),"number"==typeof e.devToolsHeight&&e.devToolsHeight>=0&&e.devToolsHeight<=100&&t.push("devtoolsheight="+Math.round(e.devToolsHeight))),t.length?"?"+t.join("&"):""}function o(e,n,i){if(null===e.parentNode)throw new Error("Invalid Element");n.id=e.id,function(e,n){n&&(n.hasOwnProperty("height")&&(e.height=""+n.height),n.hasOwnProperty("width")&&(e.width=""+n.width));e.height||(e.height=t);e.width||e.setAttribute("style","width:100%;")}(n,i),e.parentNode.replaceChild(n,e)}function r(e){if("string"==typeof e){var t=document.getElementById(e);if(null!==t)return t}else if(e instanceof HTMLElement)return e;throw new Error("Invalid Element")}function a(e){return e&&!1===e.newWindow?"_self":"_blank"}var d=function(e){var t=this;this.pending={},this.port=e,this.port.onmessage=function(e){if(e.data.payload.__reqid){var n=e.data.payload.__reqid,i=e.data.payload.__success;if(t.pending[n]){if(delete e.data.payload.__reqid,delete e.data.payload.__success,i){var o=0===Object.keys(e.data.payload).length&&e.data.payload.constructor===Object?null:e.data.payload;t.pending[n].resolve(o)}else{var r=e.data.payload.error?e.data.type+": "+e.data.payload.error:e.data.type;t.pending[n].reject(r)}delete t.pending[n]}}}};d.prototype.request=function(e){var t=this,i=n();return new Promise(function(n,o){t.pending[i]={resolve:n,reject:o},e.payload.__reqid=i,t.port.postMessage(e)})};var c=function(e,t){var n=this;this.rdc=new d(e),this.preview={},Object.defineProperty(this.preview,"origin",{value:t.previewOrigin,writable:!1}),this.editor={openFile:function(e){return n.rdc.request({type:"SDK_OPEN_FILE",payload:{path:e}})}}};c.prototype.applyFsDiff=function(e){return this.rdc.request({type:"SDK_APPLY_FS_DIFF",payload:e})},c.prototype.getFsSnapshot=function(){return this.rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},c.prototype.getDependencies=function(){return this.rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})};var p=[],s=["angular-cli","create-react-app","javascript","node","polymer","html","typescript","vue"];function l(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function u(e){-1===s.indexOf(e.template)&&console.warn("Unsupported project template, must be one of: "+s.join(", "));var t=document.createElement("form");return t.method="POST",t.setAttribute("style","display:none!important;"),t.appendChild(l("project[title]",e.title)),t.appendChild(l("project[description]",e.description)),t.appendChild(l("project[template]",e.template)),e.dependencies&&t.appendChild(l("project[dependencies]",JSON.stringify(e.dependencies))),e.settings&&t.appendChild(l("project[settings]",JSON.stringify(e.settings))),Object.keys(e.files).forEach(function(n){t.appendChild(l("project[files]["+n+"]",e.files[n]))}),t}var h={connect:function(e){if(!e||!e.contentWindow)return Promise.reject("Provided element is not an iframe.");var t,i,o=(i=(t=e)instanceof Element?"element":"id",p.find(function(e){return e[i]===t})||null);return o?o.pending:new function(e){var t=this;this.id=n(),this.element=e,this.pending=new Promise(function(e,n){var i=function(n){n.data.action&&"SDK_INIT_SUCCESS"===n.data.action&&n.data.id===t.id&&(t.vm=new c(n.ports[0],n.data.payload),e(t.vm),r())},o=function(){t.element.contentWindow&&t.element.contentWindow.postMessage({action:"SDK_INIT",id:t.id},"*")};function r(){window.clearInterval(d),window.removeEventListener("message",i)}window.addEventListener("message",i),o();var a=0,d=window.setInterval(function(){if(t.vm)r();else{if(a>=20)return r(),n("Timeout: Unable to establish a connection with the StackBlitz VM"),void p.forEach(function(e,n){e.id===t.id&&p.splice(n,1)});a++,o()}},500)}),p.push(this)}(e).pending},openGithubProject:function(t,n){window.open(e(n)+"/github/"+t+i(n),a(n))},openProject:function(t,n){var o,r;o=n,(r=u(t)).action=e(o)+"/run"+i(o),r.target=a(o),document.body.appendChild(r),r.submit(),document.body.removeChild(r)},openProjectId:function(t,n){window.open(e(n)+"/edit/"+t+i(n),a(n))},embedGithubProject:function(t,n,a){var d=r(t),c=document.createElement("iframe");return c.src=e(a)+"/github/"+n+i(a),o(d,c,a),h.connect(c)},embedProject:function(t,n,a){var d,c,p=r(t),s=(d=a,(c=u(n)).action=e(d)+"/run"+i(d),c.id="sb","<html><head><title></title></head><body>"+c.outerHTML+"<script>document.getElementById('sb').submit();<\/script></body></html>"),l=document.createElement("iframe");return o(p,l,a),l.contentDocument&&l.contentDocument.write(s),h.connect(l)},embedProjectId:function(t,n,a){var d=r(t),c=document.createElement("iframe");return c.src=e(a)+"/edit/"+n+i(a),o(d,c,a),h.connect(c)}};return h});
//# sourceMappingURL=sdk.umd.js.map
